# سیستم مدیریت سفارشات - AdminOrders

## نمای کلی

این صفحه یک سیستم جامع مدیریت سفارشات برای ادمین است که امکان مشاهده، فیلتر، جستجو و مدیریت تمام سفارشات را فراهم می‌کند.

## ویژگی‌های اصلی

### 1. آمار و گزارش‌ها (Dashboard Stats)
- **کل سفارشات**: تعداد کل سفارشات ثبت شده
- **در انتظار**: سفارشات در انتظار تایید
- **تایید شده**: سفارشات تایید شده و آماده اختصاص
- **در حال انجام**: سفارشات در مسیر
- **تکمیل شده**: سفارشات موفق انجام شده
- **درآمد کل**: مجموع درآمد از سفارشات تکمیل شده

### 2. سیستم فیلتر و جستجو
#### فیلترهای موجود:
- **جستجو**: جستجو بر اساس شماره سفارش، نام مشتری یا شماره تلفن
- **وضعیت**: فیلتر بر اساس وضعیت سفارش (همه، در انتظار، تایید شده، و...)
- **راننده**: فیلتر بر اساس اختصاص راننده (همه، اختصاص داده شده، بدون راننده)
- **تاریخ**: فیلتر زمانی (همه، امروز، هفته گذشته، ماه گذشته)

### 3. جدول سفارشات
جدول کامل با ستون‌های زیر:
- شماره سفارش + امتیاز (در صورت وجود)
- اطلاعات مشتری (نام و شماره تلفن)
- مسیر (مبدا، مقصد، مسافت و زمان)
- اطلاعات راننده (نام، پلاک، نوع وسیله)
- وضعیت با Badge رنگی
- تاریخ و زمان
- قیمت (تخمینی یا نهایی)
- منوی عملیات

### 4. عملیات روی سفارشات
#### عملیات اصلی:
1. **مشاهده جزئیات**: نمایش اطلاعات کامل سفارش در دیالوگ چند تب
2. **تغییر وضعیت**: تغییر وضعیت سفارش با امکان افزودن یادداشت
3. **اختصاص راننده**: انتخاب و اختصاص راننده به سفارش
4. **حذف سفارش**: حذف سفارش با تایید

### 5. دیالوگ جزئیات سفارش
دیالوگ کامل با 4 تب:

#### تب 1: اطلاعات اصلی
- وضعیت و امتیاز سفارش
- تاریخ ثبت
- جزئیات خدمات (نوع وسیله، کارگرها، بسته‌بندی)
- اطلاعات طبقات (طبقه مبدا/مقصد، آسانسور)

#### تب 2: مشتری و راننده
- اطلاعات کامل مشتری
- اطلاعات کامل راننده (در صورت اختصاص)
- امکان اختصاص راننده (اگر هنوز اختصاص نداده)

#### تب 3: مسیر و آدرس
- آدرس مبدا با نقشه و جزئیات
- آدرس مقصد با نقشه و جزئیات
- مسافت، زمان تخمینی و توقف‌های میانی

#### تب 4: مالی و قیمت
- قیمت تخمینی اولیه
- قیمت نهایی (در صورت تکمیل)
- اختلاف قیمت
- زمان‌بندی کامل (ثبت، درخواستی، تکمیل)

### 6. دیالوگ اختصاص راننده
- لیست رانندگان فعال و تایید شده
- فیلتر خودکار رانندگان آنلاین
- نمایش اطلاعات کامل راننده انتخابی:
  - نام، شماره تماس، امتیاز
  - نوع وسیله و پلاک
  - تعداد کارگر و تعداد سفرها
- تایید و اختصاص راننده

### 7. دیالوگ تغییر وضعیت
- انتخاب وضعیت جدید از لیست کشویی
- افزودن یادداشت یا دلیل تغییر (اختیاری)
- تایید تغییر وضعیت

### 8. دیالوگ حذف سفارش
- نمایش خلاصه اطلاعات سفارش
- هشدار قرمز رنگ
- تایید حذف با احتیاط

## Mock Data

### سفارشات (Orders)
- **تعداد**: 25 سفارش نمونه
- **وضعیت‌های مختلف**: شامل تمام حالات ممکن
- **محدوده زمانی**: 30 روز گذشته
- **قیمت**: از 1 میلیون تا 5 میلیون تومان
- **مسافت**: از 5 تا 35 کیلومتر

### رانندگان (Drivers)
- **تعداد**: 3 راننده نمونه
- **انواع وسیله**: وانت، نیسان، کامیون
- **وضعیت**: آنلاین/آفلاین، فعال/غیرفعال
- **مدارک**: تایید شده

## رنگ‌بندی وضعیت‌ها

| وضعیت | رنگ | معنی |
|-------|-----|------|
| در انتظار تایید | زرد | نیاز به بررسی ادمین |
| تایید شده | آبی | تایید شده و آماده اختصاص راننده |
| اختصاص داده شده | بنفش | راننده اختصاص داده شده |
| در حال انجام | نارنجی | در مسیر و در حال انجام |
| تکمیل شده | سبز | با موفقیت انجام شده |
| لغو شده | قرمز | لغو شده توسط ادمین یا مشتری |

## قابلیت‌های اضافی

### خروجی اکسل
- دکمه "خروجی اکسل" برای دانلود گزارش
- شامل تمام سفارشات فیلتر شده

### بازنشانی فیلترها
- دکمه "بازنشانی فیلترها" برای حذف تمام فیلترها

### Responsive Design
- طراحی کاملاً ریسپانسیو
- سازگار با موبایل، تبلت و دسکتاپ
- جداول اسکرول‌پذیر برای صفحه‌های کوچک

## استفاده

```tsx
import AdminOrders from './pages/admin/AdminOrders';

// در Route
<Route path="/admin/orders" element={<AdminOrders />} />
```

## وابستگی‌ها

- React + TypeScript
- Shadcn UI Components
- Lucide React Icons
- Sonner (Toast Notifications)
- Types از `/types/index.ts`

## به‌روزرسانی‌های آینده

امکانات پیشنهادی برای نسخه‌های بعدی:
- [ ] نمایش سفارشات روی نقشه
- [ ] فیلتر پیشرفته با تاریخ سفارشی
- [ ] صادرات PDF
- [ ] ارسال اعلان به مشتری/راننده
- [ ] تاریخچه تغییرات وضعیت
- [ ] نمودارهای آماری
- [ ] یادداشت‌های داخلی برای هر سفارش
- [ ] ادغام با سیستم پیامک
- [ ] محاسبه خودکار کمیسیون راننده

## نکات مهم

1. **Mock Data**: فعلاً از داده‌های ساختگی استفاده می‌شود. برای production باید با API واقعی جایگزین شود.
2. **State Management**: فعلاً از useState استفاده می‌شود. برای مقیاس بزرگتر، استفاده از Context یا Redux توصیه می‌شود.
3. **Real-time Updates**: برای نمایش به‌روزرسانی‌های لحظه‌ای، نیاز به WebSocket یا Polling است.
4. **Permissions**: باید سیستم مجوزدهی برای عملیات حساس اضافه شود.

## تاریخچه تغییرات

- **v1.0.0** (شنبه 8 آبان 1404): پیاده‌سازی اولیه کامل
  - سیستم فیلتر و جستجو
  - جدول سفارشات
  - دیالوگ‌های مدیریت (جزئیات، اختصاص راننده، تغییر وضعیت، حذف)
  - آمار و گزارش‌ها
  - Mock data کامل
