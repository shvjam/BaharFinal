# تغییرات: افزودن فیلد کارگر همراه به رانندگان

**تاریخ**: 8 نوامبر 2025  
**نسخه**: 1.1.0

## خلاصه تغییرات
فیلد "تعداد کارگر همراه" به اطلاعات هر راننده اضافه شد. این فیلد مشخص می‌کند که هر راننده چند کارگر می‌تواند همراه خود داشته باشد.

## فایل‌های تغییر یافته

### 1. `/types/index.ts`
#### تغییرات:
- فیلد `availableWorkers: number` به interface Driver اضافه شد
- این فیلد در بخش "وسیله نقلیه" قرار گرفت

```typescript
interface Driver extends User {
  // ...
  // وسیله نقلیه
  licensePlate: string;
  vehicleType: VehicleType;
  vehicleModel?: string;
  vehicleColor?: string;
  vehicleYear?: number;
  availableWorkers: number; // تعداد کارگر همراه ← جدید
  // ...
}
```

### 2. `/pages/admin/AdminDrivers.tsx`
#### تغییرات متعدد:

**الف) Mock Data:**
- به هر راننده نمونه، فیلد `availableWorkers` اضافه شد:
  - احمد محمدی: 2 کارگر
  - حسین رضایی: 3 کارگر
  - علی کریمی: 1 کارگر

**ب) State فرم راننده:**
- فیلد `availableWorkers: 0` به state اولیه فرم اضافه شد
- در `handleAddDriver`: مقداردهی اولیه به 0
- در `handleEditDriver`: خواندن مقدار از راننده انتخاب شده
- در `handleSaveDriver`: ذخیره مقدار در هر دو حالت افزودن و ویرایش

**ج) UI جدول رانندگان:**
- در ستون "وسیله نقلیه"، اطلاعات کارگر همراه به صورت یک ردیف جدید نمایش داده می‌شود:
```tsx
<div className="flex items-center gap-1 text-xs text-muted-foreground">
  <Users className="h-3 w-3" />
  {driver.availableWorkers} کارگر همراه
</div>
```

**د) فرم افزودن/ویرایش راننده:**
- در تب "وسیله نقلیه"، فیلد جدید اضافه شد:
  - نوع: عددی (number input)
  - محدوده: 0 تا 10
  - راهنما: "تعداد کارگرانی که می‌توانند همراه راننده باشند"
  - اجباری (علامت * دارد)

**ه) صفحه جزئیات راننده:**
- در بخش "اطلاعات وسیله نقلیه"، ردیف جدید برای نمایش تعداد کارگر همراه:
```tsx
<div className="space-y-1">
  <div className="text-sm text-muted-foreground">تعداد کارگر همراه</div>
  <div className="flex items-center gap-2">
    <Users className="h-4 w-4 text-muted-foreground" />
    <span>{selectedDriver.availableWorkers} نفر</span>
  </div>
</div>
```

### 3. `/pages/admin/AdminDrivers.README.md`
#### تغییرات مستندات:

**الف) بخش "تب وسیله نقلیه":**
- آیتم جدید اضافه شد: "تعداد کارگر همراه (اجباری): تعداد کارگرانی که می‌توانند همراه راننده باشند (0-10)"

**ب) بخش "اطلاعات وسیله نقلیه" در جزئیات:**
- "تعداد کارگر همراه" به لیست اضافه شد

**ج) بخش "ساختار داده":**
- فیلد `availableWorkers: number` در نمونه کد TypeScript اضافه شد

**د) بخش "Mock Data":**
- توضیحات راننده‌های نمونه آپدیت شد و تعداد کارگر همراه هر کدام ذکر شد

### 4. `/App.tsx`
- مسیر `/admin/drivers` به روت‌های ادمین اضافه شده بود (قبلاً انجام شده)

### 5. `/components/layout/AdminLayout.tsx`
- آیتم منوی "مدیریت رانندگان" با آیکون UserCog اضافه شده بود (قبلاً انجام شده)

## ویژگی‌های فیلد جدید

### محدودیت‌ها:
- **حداقل**: 0 (بدون کارگر همراه)
- **حداکثر**: 10 (حداکثر 10 کارگر همراه)
- **نوع**: عدد صحیح (integer)
- **اجباری**: بله (در فرم با * مشخص شده)

### موارد استفاده:
1. **مشاهده در لیست**: در جدول رانندگان، زیر اطلاعات وسیله نقلیه
2. **ویرایش**: در فرم افزودن/ویرایش راننده، تب "وسیله نقلیه"
3. **نمایش جزئیات**: در دیالوگ جزئیات راننده، بخش "اطلاعات وسیله نقلیه"

### نمایش بصری:
- در لیست: آیکون Users + متن
- در جزئیات: آیکون Users + "X نفر"
- رنگ: text-muted-foreground (خاکستری ملایم)
- اندازه آیکون: 3x3 در لیست، 4x4 در جزئیات

## کاربرد در سیستم

این فیلد به ادمین اجازه می‌دهد:
1. مشخص کند هر راننده چند کارگر در اختیار دارد
2. در زمان تخصیص سفارش، رانندگانی با تعداد کارگر مناسب انتخاب شوند
3. محاسبه دقیق‌تر هزینه‌ها بر اساس تعداد کارگران موجود
4. برنامه‌ریزی بهتر برای سفارشاتی که نیاز به کارگر دارند

## مثال‌های استفاده:

### سناریو 1: سفارش بدون نیاز به کارگر
- مشتری نیازی به کارگر ندارد
- می‌تواند از رانندگان با `availableWorkers = 0` استفاده کند

### سناریو 2: سفارش نیاز به 2 کارگر
- سیستم فقط رانندگانی را نمایش می‌دهد که `availableWorkers >= 2`

### سناریو 3: تغییر ظرفیت راننده
- ادمین می‌تواند در صورت تغییر تیم راننده، تعداد کارگران را به‌روزرسانی کند

## نکات مهم:

1. **مقدار پیش‌فرض**: برای رانندگان جدید، مقدار پیش‌فرض 0 است
2. **اجباری بودن**: این فیلد باید حتماً پر شود (نمی‌تواند خالی باشد)
3. **اعتبارسنجی**: ورودی باید عدد بین 0 تا 10 باشد
4. **یکپارچگی با سفارشات**: در آینده باید با فیلد `workerCount` در سفارشات هماهنگ شود

## تست‌های پیشنهادی:

1. ✅ افزودن راننده با 0 کارگر
2. ✅ افزودن راننده با 5 کارگر
3. ✅ ویرایش تعداد کارگر راننده موجود
4. ✅ نمایش صحیح در لیست رانندگان
5. ✅ نمایش صحیح در جزئیات راننده
6. ⏳ فیلتر کردن رانندگان بر اساس تعداد کارگر (آینده)
7. ⏳ تخصیص خودکار راننده بر اساس نیاز سفارش (آینده)

## تغییرات آینده پیشنهادی:

1. **فیلتر کارگر همراه**: افزودن فیلتر در لیست رانندگان بر اساس تعداد کارگر
2. **نمودار آماری**: نمایش توزیع رانندگان بر اساس تعداد کارگر
3. **پیشنهاد هوشمند**: در زمان تخصیص سفارش، پیشنهاد رانندگان مناسب بر اساس نیاز به کارگر
4. **مدیریت هزینه کارگر**: لینک دادن تعداد کارگر به محاسبات قیمت‌گذاری
5. **گزارش بهره‌وری**: آمار استفاده از کارگران در سفارشات

## نتیجه‌گیری

این تغییرات به طور کامل ویژگی "تعداد کارگر همراه" را به سیستم مدیریت رانندگان اضافه کرده است. اکنون ادمین می‌تواند برای هر راننده مشخص کند که چند کارگر در اختیار دارد و این اطلاعات در تمام بخش‌های مرتبط نمایش داده می‌شود.
